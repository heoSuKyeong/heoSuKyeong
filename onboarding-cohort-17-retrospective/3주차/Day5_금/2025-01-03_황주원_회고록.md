# Daily Retrospective  
**작성자**: [황주원]  
**작성일시**: [2025-01-03]  

## 1. 오늘 배운 내용 (필수)  

중학교 학급에 세 학생이 있을 때, 선생님이 학생 이름을 다 외우진 못 했다. 

이럴 때 통상적으로 쓰이는 '역할' 이 정해져 있으면 '반장 청소해' 하면 홍길동이 알아서 한다. 

이 방식에서 역할 - refer_type, 번호 - prop_id 로 매칭된다. <br />
refer_type은 중복 값이면 안되며 필수 값이어야 한다. 

| 번호 | 이름  | 역할|
| ---- | ------- | ---- | 
| 1 | 홍길동 | 반장 | 
| 2 | 김아무개 | 부반장 | 
| 3 | 황주원 | 당번 | 

* 개발 로직에서는 'prop_id'를 안 쓰려고 한다. 
-> 번호일 뿐이기에 

🤔 승준님의 질문 > 그럼 prop에서 가져오는 prop_id는 써도 괜찮은거 아닌가요??

🅰️ 이건 YES ! 직접적으로 propID("title") 이렇게 가져오는 것이 안되고, propID(prop.prop_id)는 괜찮다. 

<br />

## DataModel
key와 value로 구성된 Object를 의미
- UI, 웹서버에서 사용하는 데이터를 담는 그릇

1. prop_id(항목)

- DataModel 내의 특정 항목을 지칭
- 동일 DataModel 내에서 중복되어서는 안된다. 

### DataModel Definition
특정 DataModel을 설명하는 Object

DataModel Definition에는 DataModel이 가지는 각 Value들의 모양(data_type), 규칙(attribute), 의미(refer_type)을 정의한다.

```typescript
const board_definition = {
    data_model_id: "board", // DataModel - DataModel Definition 연결 id
    props: [ // 모든 항목(prop_id)에 대한 명세 정의
        {
            prop_id: "title",
            data_type: "$$txt", // 값에 대한 데이터 구조 정보
            refer_type: "title" // 항목(prop_id)의 의미
        },
        {
            prop_id: "writer",
            data_type: "$$code",
            refer_type: "user"
        },
    ],
    attributes: [ // 각 항목(prop_id)가 가지고 있는 값을 다루기 위한 규칙
        {
            prop_id: "title",
            attr_id: "max_length", // 규칙 이름
            data: 20 // 구현 로직에서 사용될 데이터
        },
        {
            prop_id: "title",
            attr_id: "not_null",
            data: true
        }        
    ]
}
```

### DMC(Data Model Container)
DataModel + DataModel Definition

아래의 데이터 흐름 모든 구간에서 DMC를 전달하며 데이터를 처리한다.

![데이터 흐름](../ref/2025-01-03%20황주원%20흐름.png)

<br />

### 싱글 & 멀티 테이블
아래 그림에서 윗 박스 부분(상단)이 싱글 테이블 부분, 밑 박스 부분(하단)이 멀티 테이블 부분이다.

![싱글 멀티 테이블](../ref/2025-01-03%20황주원%20싱글%20멀티.png)
[싱글 테이블]
| tenant_sid | record_sid |	data_sid	| No	|	title	|	content	| notice_limit	| class |	bizz_sid |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| 80000	| r1 | d1 | 1 |	title1 | content1 | 2025-01-03 | null | 공지사항 |
| 80000	| r2 | d2 | 2 |	title2 | content2  | 2025-01-04 | null | 공지사항 |
| 80000	| r3 | **d3** |	1 |	개념숙제 | content3 | 2025-01-04 | 개념 | 숙제 |

[멀티 테이블]

| tenant_sid | record_sid |	data_sid	| No	|	title	|	content	| notice_limit	| class |	bizz_sid |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| 80000	| r4 | **d3** | 1 |	개념숙제 |  | | 개념 | 숙제 |
| 80000	| r5 | **d3** | 1 |	개념숙제 |   |  | 개념 | 숙제 |
| 80000	| r6 | **d3** |	1 |	개념숙제 |  |  | 개념 | 숙제 |

테이블 구조는 다음과 같이 된다. 
- tenant_sid: 회사 구분 
- record_sid: row 별 구분 키 값
- data_sid: 싱글과 멀티 테이블을 이어주는 id 값
- No: 보여지는 화면(공지사항/숙제)에서의 순서
    - (tenant_sid + bizz_sid) 기준으로 증가
- title: 제목
- content: 내용
- notice_limit: 공지기간
- class: 과목
- bizz_sid: 업무(15자리)


## 2. 동기에게 도움 받은 내용 (필수)
- 현철님께서 제 컴퓨터 로그인이 안 되는 문제 타 팀에 문의하여 해결해 주셨습니다. 감사합니다 ! 
- 오후에 따뜻해서 졸릴 때 동기들과 잠깐의 간식 타임을 가지며 리프레쉬 할 수 있었습니다. (성철님의 케이크도 맛있었습니다.)

---

## 3. 개발 기술적으로 성장한 점 (선택)

### 1. 교육 과정 상 배운 내용이 아닌 개인적 호기심을 해결하기 위해 추가 공부한 내용

### 1.1 인조 식별자
데이터를 식별하기 위해 인위적으로 만들어진 식별자

인조 식별자는 시스템 내에서만 의미가 있으며, 사용자의 실제 정보와는 독립적으로 생성된다.

비즈니스적 의미를 내포하지 않고, 한 번 생성되면 변경되지 않는다.

### 1.2 DB 테이블 하나로 제목 여러개, 내용 여러개일 경우 어떻게 DB 테이블을 설계할지 고민해봐라 

###### 부문장님께서 해당 질문에 대해 고민해 보고 다음에 시간될 때 답을 알려주시겠다고 하셔서 고민해 보는 시간을 가졌습니다. 

저라면 제목 1을 제외한 다른 속성들은 JSON으로 저장할 것 같습니다. 필요할 때마다 테이블의 컬럼을 계속해서 증가한다면 데이터 구조가 변동이 되고, 다른 테이블간의 관계가 있다면 위험할 수 있습니다. 또한, 유지보수 관점에서도 변동이 있을 때마다 DB와 코드 둘 다 건들여야 한다면 굉장히 비용이 많이 드는 작업이 될 것이라 생각합니다. 

제목 1을 제외하는 이유는 ? 검색에 있어서는 보통 제목 1, 2, 3 모든 결과가 도출되지는 않습니다. 게시판을 예로든다면 UI적으로 모든 컬럼을 보여주지 않기 때문에 직접적으로 화면에 보이는 컬럼들만 검색이 된다는 가정하에 제목 1, 내용 1, 등만을 빼는 것으로 결정하였습니다. 

그럼 제목 2, 3도 검색하고 싶을 땐 ? JSON에서 key 값을 검색하면 정말 오래 걸립니다. 경험상 10만건의 데이터가 쌓여있고 JSON 길이도 600 이상, JOIN이 2번 걸려있을 때 mariaDB 기준으로 검색 시간은 약 5분, workbench에서는 응답없음 화면이 나오고 강제종료됩니다. <br />
당시에는 컬럼을 추가하지도 JSON parser를 쓰지 못하는 상황이였어서 검색을 했을 때 JSON을 파싱하고, '기간'을 설정해서 조회 가능한 프로시저를 짰습니다. default는 2달이였으며 1년 이상은 검색할 수 없도록 막았습니다. <br />
이렇게 시간이 오래 걸리는 경우에는 '기간'을 설정해 검색하는 방법이 있습니다. 

이 질문에 대한 답을 고민해 보며, <br />
저는 결재나 전표에서 JSON으로 저장된 데이터들을 보면서 정말 비효율적이라고 생각이 들었습니다. 
제가 맡은 과제도 '전표처리할 때 JSON으로 저장된 값을 조회하는 데 시간이 오래 걸리니 개선'하는 것 이였습니다. 그 당시에는 오래된 시스템이라서 JSON 으로 저장했구나, 검색하는 키 값을 빼서 컬럼으로 추가하고 싶은데 위험 부담이 커서 안 된다고 하네 .. 다른 방법을 찾아보자 ! 였습니다. <br />
이번 부문장님의 질문을 다시 한 번 생각해 보며 제가 잘못된 생각을 가지고 있었다는 것을 알았습니다. 해당 질문에 진짜 답이 궁금해졌고, 당시 제가 도출한 답의 정답은 없겠지만 이카운트에서 채택한 방법과도 비교해 보고 싶습니다. 

### 3. 위 두 주제 중 미처 해결 못한 과제. 앞으로 공부해볼 내용.
- table_model - DB와 소통하기 위한 목적의 데이터를 담는 그릇
    - 100% DB와 똑같이 생긴 model이라고 하셨는데, 구조가 궁금합니다.
- sid나 인조식별자에 대해 더 공부하고자 합니다.
