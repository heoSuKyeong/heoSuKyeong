# Daily Retrospective

**ì‘ì„±ì**: [í—ˆìˆ˜ê²½]  
**ì‘ì„±ì¼ì‹œ**: [2025-02-17(ì›”)]

# 1. ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš© (í•„ìˆ˜)


## slip_data_modelë¥¼ í†µí•œ validator êµ¬í˜„
- ì˜¤ëŠ˜ì€ slip_data_modelì„ ì‚¬ìš©í•˜ì—¬ Validatorë¥¼ ìƒì„±í•˜ëŠ” ì—…ë¬´ë¥¼ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.
- `slip_data_model`ì€ ì—¬ëŸ¬ ê°œ(Nê°œ)ì˜ í•­ëª© ê°’ì„ ë¹„êµí•˜ì—¬ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•´ì•¼ í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

### 1. Validator ì†ì„± ìƒì„± ê³¼ì •

#### 1. validator íƒ€ì… ë“±ë¡
- ê²½ë¡œ: 03ë ˆì´ì–´/@abstraction/types/attribute/definition/validator

```ts
// check_user_for_progress_status.ts
import { slip_validator_attr_resolver } from '../../../../dto';

export const check_user_for_progress_status = 'check_user_for_progress_status';
export type check_user_for_progress_status = slip_validator_attr_resolver & {};
```

#### 2.  Validator ë¦¬ì¡¸ë²„(Resolver) ìƒì„±
- ê²½ë¡œ: 03ë ˆì´ì–´/server/attr_generator/definition
- ë“±ë¡í•œ íƒ€ì…ì„ ê¸°ë°˜ìœ¼ë¡œ, í•´ë‹¹ íƒ€ì…ì„ ê°ì§€í•˜ë©´ íŠ¹ì • programì„ ì‹¤í–‰ì‹œí‚¤ëŠ” ë¦¬ì¡¸ë²„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

```ts
// check_user_for_progress_status.ts

export const check_user_for_progress_status: IDefinitionAttrGenerator<
	definition_attrs.validator.check_user_for_progress_status
> = (execution_context, slip_data_mdoel) => {
	return {
		attr_id: definition_attrs.validator.check_user_for_progress_status,
		attr_type: EN_ATTR_TYPE.Validator,
		prop_id: '',
		data: {
			resolver: ICheckUserForProgressStatusProgram,
			option: {},
		},
	};
};
```

#### 3. time_manage_attr_mapì— ì¶”ê°€
- ê²½ë¡œ: 03ë ˆì´ì–´/server/program/attr_generator
- ë“±ë¡í•œ Validatorë¥¼ íŠ¹ì • ë™ì‘(Create, Update ë“±)ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ attr_mapì— ì¶”ê°€í•©ë‹ˆë‹¤.
- time_manage_attr_mapì´ í•˜ëŠ” ì—­í• 
	- ExecuteSetupMainProgramì—ì„œ pre_executer_resolver, slip_initializer ë¥¼ í†µí•´ time_manage_attr_mapì— ì •ì˜ëœ ì†ì„± ì •ë³´ë¥¼ ë™ì ìœ¼ë¡œ ì¶”ê°€í•©ë‹ˆë‹¤.	
```ts
// time_manage_attr_map.ts
export const time_manage_attr_map: { [action_mode in EN_ACTION_MODE]?: string[] } = {
[EN_ACTION_MODE.Create]: [
	// [#] ì§„í–‰ì¤‘ ë³€ê²½ ì‹œ ë‹´ë‹¹ì í•„ìˆ˜ ì²´í¬
	definition_attrs.validator.check_user_for_progress_status,
],
```


### 2. validator ë‚´ìš©

```ts
// CheckUserForProgressStatusProgram.ts
@program_impl(ICheckUserForProgressStatusProgram)
export class CheckUserForProgressStatusProgram
	extends BaseProgram<IBaseSlipValidatorDto, IBaseSlipValidatorResult>
	implements ICheckUserForProgressStatusProgram
{
	private master_dmc: IDataModelContainer<any, any> | undefined;

	protected onExecute(dto: IBaseSlipValidatorDto): IBaseSlipValidatorResult {
		const result = {
			status: true,
		} as IBaseSlipValidatorResult;

		// ë°ì´í„° ì—†ëŠ”ê²½ìš° pass
		const data_model = dto.slip_data_model.data_model;
		if (_.vIsEmpty(data_model)) {
			return result;
		}

		const definition_feature = this.execution_context.getFeature<manager.IBizzManager>(manager.IBizzManager);

		const error_info_feature = this.execution_context.getFeature<IExceptionInfoFeature>(IExceptionInfoFeature);

		const data_model_id = definition_feature.getBizzDataModelId(
			this.execution_context,
			this.execution_context.action.bizz_sid,
			EN_INPUT_MENU_TYPE.Master
		); // 'time_manageXmaster'

		this.master_dmc = dto.dmc.find((x) => _.vIsEquals(x.data_model_id, data_model_id));

		// ë‹´ë‹¹ì
		const user_dto: string = this.master_dmc?.getValueByReferType<$$code>('user')?.code ?? '';

		// ì§„í–‰ìƒíƒœ
		const progress_status: string = this.master_dmc?.getValueByReferType('progress_status_nm') ?? '';

		if (_.vIsEquals(progress_status, 'ì§„í–‰ì¤‘') && _.vIsEmpty(user_dto)) {
			result.status = false;
			result.exception = ExceptionBuilder.create<ISlipValidatorException>(ISlipValidatorException, {
				data_model_id: data_model_id,
				data_model_index: 0,
				prop_id: this.master_dmc?.getPropIdByReferType('progress_status_nm'),
				key: error_info_feature.getValueByKey(_.vSafe(this.master_dmc), this.execution_context.action.bizz_sid),
				bizz_name: error_info_feature.getBizzName(),
				error_options: {
					error_message: 'ë‹´ë‹¹ìê°€ ì—†ëŠ” ì‘ì—…ì€ ì§„í–‰ì¤‘ ìƒíƒœë¡œ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',
					clear_message_trigger: { focusout: true },
					clear_trigger: { focusout: true },
				},
				display_type: EN_ERROR_DISPLAY_TYPE.ErrorBox,
				// line_no: this.master_dmc?.getValueByReferType<$$sequence>('upload_seq', 0),
			});
		}

		return result;
	}
}

```

ğŸ“Œ ìœ íš¨ì„± ê²€ì‚¬ ë¡œì§

- ì§„í–‰ ìƒíƒœ(progress_status)ê°€ "ì§„í–‰ì¤‘" ì¸ë° ë‹´ë‹¹ì(user_dto) ê°’ì´ ë¹„ì–´ ìˆë‹¤ë©´
- result.status = falseë¡œ ì„¤ì •í•˜ì—¬ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨
- ExceptionBuilder.createë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì™¸ ì •ë³´ ìƒì„±
	- ì˜ˆì™¸ ë©”ì‹œì§€: "ë‹´ë‹¹ìê°€ ì—†ëŠ” ì‘ì—…ì€ ì§„í–‰ì¤‘ ìƒíƒœë¡œ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
	- display_type: EN_ERROR_DISPLAY_TYPE.ErrorBox â†’ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë°•ìŠ¤ë¡œ í‘œì‹œ


### 3. validator ì‹¤í–‰ë¶€

- `ValidateSlipDataModelProgram.ts`ì—ì„œ ì†ì„± ì¤‘ Validator íƒ€ì…ì„ ê°€ì§€ê³  ìˆëŠ” ì†ì„±ì„ ì‹¤í–‰ì‹œí‚µë‹ˆë‹¤.
```
protected onExecute(dto: ProgramDto): ProgramResult {
	const exceptions: ISlipValidatorExceptionDto[] = [];
	for (const attr of dto.slip_attributes) {
		if (attr.attr_type == EN_ATTR_TYPE.Validator && attr.data.resolver) {
			const validator = ProgramBuilder.create<IBaseSlipValidatorDto, IBaseSlipValidatorResult>(
				attr.data.resolver,
				this.execution_context
			);
			const result = validator.execute({
				slip_data_model: dto.slip_data_model,
				dmc: dto.dmc,
				attr,
				additional_info: dto.isDerive ? dto.slip_data_model.additional_info : dto.additional_info,
			});
```



## 2. ë™ê¸°ì—ê²Œ ë„ì›€ ë°›ì€ ë‚´ìš© (í•„ìˆ˜)

- ê°•ë¯¼ë‹˜ê³¼ í˜„ì² ë‹˜ê»˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ slip_data_modelì—ì„œ ì§„í–‰í•˜ëŠ” ê³¼ì •ì— ëŒ€í•œ ì¡°ì–¸ì„ ë°›ì•˜ìŠµë‹ˆë‹¤.
- ë„í˜•ë‹˜ê»˜ì„œ DTOì— data_modelì´ ì˜¬ë°”ë¥´ê²Œ ë“¤ì–´ê°€ì§€ ì•ŠëŠ” ë¬¸ì œë¥¼ ì°¾ì•„ì£¼ì…¨ìŠµë‹ˆë‹¤.
- ì£¼ì›ë‹˜ê»˜ì„œ slip_data_modelì—ì„œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê³¼ì •ì„ ë„ì™€ì£¼ì…¨ìŠµë‹ˆë‹¤.
- ë¯¼ì¤€ë‹˜ê»˜ì„œ ì…‹ì—… ì–‘ì‹ì„ ë³€ê²½í•˜ëŠ” ë°©ë²•ì„ ì•Œë ¤ì£¼ì…¨ìŠµë‹ˆë‹¤.

---

## 3. ê°œë°œ ê¸°ìˆ ì ìœ¼ë¡œ ì„±ì¥í•œ ì  (ì„ íƒ)

ì•„ë˜ì˜ 3ê°€ì§€ ì£¼ì œ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì—¬ ì‘ì„±í•©ë‹ˆë‹¤.

### 1. êµìœ¡ ê³¼ì • ìƒ ë°°ìš´ ë‚´ìš©ì´ ì•„ë‹Œ ê°œì¸ì  í˜¸ê¸°ì‹¬ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ì¶”ê°€ ê³µë¶€í•œ ë‚´ìš©

### 2. ì˜¤ëŠ˜ ì§ë©´í–ˆë˜ ë¬¸ì œ (ê°œë°œ í™˜ê²½, êµ¬í˜„)ì™€ í•´ê²° ë°©ë²•

### 3. ìœ„ ë‘ ì£¼ì œ ì¤‘ ë¯¸ì²˜ í•´ê²° ëª»í•œ ê³¼ì œ. ì•ìœ¼ë¡œ ê³µë¶€í•´ë³¼ ë‚´ìš©.

ìœ„ ì£¼ì œëŠ” ê°ê° í•˜ë‚˜ì˜ ì„ íƒí•­ëª©ìœ¼ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.
(ìœ„ ì£¼ì œì—ì„œ 2ê°œ ì‘ì„±í•˜ë©´ 2ê°œ ì„ íƒí•­ëª© ì‘ì„±í•œ ì…ˆ)

---

## 4. ì†Œí”„íŠ¸ ìŠ¤í‚¬ë©´ì—ì„œ ì„±ì¥í•œ ì  (ì„ íƒ)

ë‚´ê°€ ëª¨ë¥´ëŠ” ê°œë…ì„ ì„¤ëª…ë°›ê¸° ìœ„í•´ ì–´ë–¤ ê³¼ì •ì—ì„œ ë§‰í˜”ëŠ”ì§€, ì‹œë„í–ˆë˜ í•´ê²° ë°©ë²•ì€ ë¬´ì—‡ì¸ì§€, ì •í™•íˆ ì–´ë–¤ ë¶€ë¶„ì´ ì´í•´ë˜ì§€ ì•ŠëŠ”ì§€ë¥¼ ì •ë¦¬í•˜ì—¬ ì§ˆë¬¸í•˜ëŠ” ìŠµê´€ì„ ë“¤ì´ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
ì´ë¥¼ í†µí•´ ë§‰ì—°í•œ ì§ˆë¬¸ì´ ì•„ë‹ˆë¼ êµ¬ì²´ì ì¸ ìƒí™©ê³¼ ë§¥ë½ì„ ì „ë‹¬í•˜ëŠ” ì§ˆë¬¸ì„ í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆê³ , ë•ë¶„ì— ë”ìš± íš¨ê³¼ì ìœ¼ë¡œ ë‹µë³€ì„ ë°›ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

ë˜í•œ, ì§ˆë¬¸ì„ í•˜ë©´ì„œ ë‹¨ìˆœíˆ ë‹µì„ ë“£ëŠ” ê²ƒì—ì„œ ëë‚˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë‹µë³€ì„ í†µí•´ ì–»ì€ ì •ë³´ë¥¼ ë‹¤ì‹œ ë‚´ ë°©ì‹ìœ¼ë¡œ ì •ë¦¬í•˜ê³ , ì ìš©í•´ë³´ëŠ” ê³¼ì •ì„ ê±°ì¹˜ë©° ì‹¤ì§ˆì ì¸ í•™ìŠµìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆë„ë¡ ë…¸ë ¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.